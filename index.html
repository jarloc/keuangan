<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Personal Finance</title>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>

<style>
:root{
  --gold:#d4af37;
  --black:#0b0b0b;
  --white:#fff;
}
body,html{
  margin:0;padding:0;font-family:Segoe UI,Arial;height:100%;background:linear-gradient(135deg,#000,#111,#000);color:var(--white);
  overflow-x:hidden;
}
button{cursor:pointer;transition:.2s;border-radius:12px;padding:10px 16px;border:1px solid var(--gold);background:transparent;color:var(--gold);}
button:hover{box-shadow:0 0 20px rgba(212,175,55,.8);}
button:active{transform:scale(.95);}
.fab{position:fixed;right:25px;bottom:25px;width:60px;height:60px;border-radius:50%;background:linear-gradient(135deg,var(--gold),#fff2b0);color:#000;font-size:28px;border:none;box-shadow:0 0 25px rgba(212,175,55,.9);animation:float 3s ease-in-out infinite;}
@keyframes float{50%{transform:translateY(-10px);}}
.modal{position:fixed;inset:0;background:rgba(0,0,0,.7);display:none;align-items:center;justify-content:center;opacity:0;transition:opacity .3s;}
.modal-content{background:#000;padding:20px;border-radius:16px;border:1px solid var(--gold);width:320px;transform:translateY(50px);transition:transform .3s;}
.modal.show{opacity:1;}
.modal.show .modal-content{transform:translateY(0);}
input,select{width:100%;margin-top:8px;padding:8px;background:#111;color:#fff;border:1px solid #333;border-radius:8px;}

/* ===== Welcome Screen ===== */
#welcome{display:flex;align-items:center;justify-content:center;height:100%;flex-direction:column;animation:fadeIn 1s ease forwards;}
#welcome.fadeOut{animation:fadeOut 0.7s ease forwards;}
#welcome h1{color:var(--gold);letter-spacing:2px;margin-bottom:20px;}
#welcome input{margin:5px 0;width:250px;padding:10px;border-radius:10px;border:1px solid rgba(212,175,55,.5);}
#welcome button{width:150px;margin-top:10px;animation:glow 2s infinite alternate;}
@keyframes glow{0%{box-shadow:0 0 5px rgba(212,175,55,.5);}100%{box-shadow:0 0 25px rgba(212,175,55,1);}}
@keyframes fadeIn{0%{opacity:0}100%{opacity:1}}
@keyframes fadeOut{0%{opacity:1}100%{opacity:0;display:none}}

/* ===== Main Web ===== */
#main{display:none;opacity:0;transition:opacity .5s;}
#main.show{display:block;opacity:1;}
header{padding:20px;text-align:center;border-bottom:1px solid rgba(212,175,55,.3);}
header h1{margin:0;color:var(--gold);letter-spacing:2px;}
header p{margin-top:5px;opacity:.7;}
header div{margin-top:10px;}
.card{margin:20px;padding:20px;border-radius:16px;background:rgba(15,15,15,.9);border:1px solid rgba(212,175,55,.25);box-shadow:0 0 25px rgba(212,175,55,.15);}
.saldo{display:grid;gap:15px;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));}
.box{background:#000;padding:15px;border-radius:14px;border:1px solid rgba(212,175,55,.3);}
.box h3{margin:0;color:var(--gold);font-size:.9rem;}
.box strong{font-size:1.4rem;}
table{width:100%;border-collapse:collapse;}
th,td{padding:10px;border-bottom:1px solid #222;}
th{color:var(--gold);}
tr:hover{background:rgba(212,175,55,.05);}
</style>
</head>
<body>

<!-- Welcome Screen -->
<div id="welcome">
  <h1>WELCOME</h1>
  <input type="email" id="email" placeholder="Email Admin">
  <input type="password" id="password" placeholder="Password">
  <button onclick="login()">LOGIN</button>
</div>

<!-- Main Web -->
<div id="main">
<header>
<h1>PERSONAL FINANCE</h1>
<p id="status">ADMIN OFF</p>
<div>
<select id="bulan" onchange="changePeriod()"></select>
<select id="tahun" onchange="changePeriod()"></select>
</div>
</header>

<div class="card">
<div class="saldo">
  <div class="box"><h3>SALDO ATM</h3><strong id="atm">0</strong></div>
  <div class="box"><h3>SALDO CASH</h3><strong id="cash">0</strong></div>
  <div class="box"><h3>TOTAL</h3><strong id="total">0</strong></div>
</div>
</div>

<div class="card">
<h3 style="color:var(--gold)">Riwayat</h3>
<table>
<thead><tr><th>Tgl</th><th>Ket</th><th>Metode</th><th>Nominal</th></tr></thead>
<tbody id="list"></tbody>
</table>
</div>

<button class="fab" onclick="openForm()">+</button>

<div class="modal" id="modal">
<div class="modal-content">
<h3 style="color:var(--gold)">Input Transaksi</h3>
<select id="jenis">
  <option value="masuk">Pemasukan</option>
  <option value="keluar">Pengeluaran</option>
</select>
<select id="metode">
  <option value="atm">ATM</option>
  <option value="cash">Cash</option>
</select>
<input id="ket" placeholder="Keterangan">
<input id="nominal" type="number" placeholder="Nominal">
<button onclick="simpan()">Simpan</button>
<button onclick="closeForm()">Tutup</button>
</div>
</div>
</div>

<script>
// Firebase config
const firebaseConfig = {
  apiKey: "API_KEY",
  authDomain: "PROJECT.firebaseapp.com",
  projectId: "PROJECT_ID",
};
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();

// Admin & Data
let isAdmin = false;
let atm=0,cash=0,data=[];
const atmEl = document.getElementById('atm');
const cashEl = document.getElementById('cash');
const total = document.getElementById('total');
const list = document.getElementById('list');
const status = document.getElementById('status');
const modal = document.getElementById('modal');
const welcome = document.getElementById('welcome');
const main = document.getElementById('main');
const bulanEl = document.getElementById('bulan');
const tahunEl = document.getElementById('tahun');
const bulanNama = ["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Agu","Sep","Okt","Nov","Des"];

// Periode setup
for(let i=0;i<12;i++){let o=document.createElement("option");o.value=i+1;o.textContent=bulanNama[i];bulanEl.appendChild(o);}
const currentYear=new Date().getFullYear();
for(let y=currentYear-5;y<=currentYear+5;y++){let o=document.createElement("option");o.value=y;o.textContent=y;tahunEl.appendChild(o);}
let periode={bulan:new Date().getMonth()+1,tahun:new Date().getFullYear()};
bulanEl.value=periode.bulan;tahunEl.value=periode.tahun;

// Load / Save per-periode
function loadData(){
  const key=`data_${periode.tahun}_${periode.bulan}`;
  atm=+localStorage[`atm_${periode.tahun}_${periode.bulan}`]||0;
  cash=+localStorage[`cash_${periode.tahun}_${periode.bulan}`]||0;
  data=JSON.parse(localStorage[key]||"[]");
  render();
}
function saveData(){
  const key=`data_${periode.tahun}_${periode.bulan}`;
  localStorage[`atm_${periode.tahun}_${periode.bulan}`]=atm;
  localStorage[`cash_${periode.tahun}_${periode.bulan}`]=cash;
  localStorage[key]=JSON.stringify(data);
}

// Render
function render(){
  atmEl.textContent=atm;
  cashEl.textContent=cash;
  total.textContent=atm+cash;
  list.innerHTML="";
  data.forEach(d=>{
    list.innerHTML+=`<tr><td>${d.tgl}</td><td>${d.ket}</td><td>${d.metode}</td><td>${d.nominal}</td></tr>`;
  });
}

// Change period
function changePeriod(){periode.bulan=+bulanEl.value;periode.tahun=+tahunEl.value;loadData();}

// Modal
function openForm(){if(!isAdmin)return alert("Login admin dulu");modal.classList.add("show");}
function closeForm(){modal.classList.remove("show");}

// Simpan transaksi
function simpan(){
  const j=document.getElementById('jenis').value;
  const m=document.getElementById('metode').value;
  const n=+document.getElementById('nominal').value;
  const k=document.getElementById('ket').value;
  if(j==="masuk"){m==="atm"?atm+=n:cash+=n;}else{m==="atm"?atm-=n:cash-=n;}
  data.unshift({tgl:new Date().toLocaleDateString(),ket:k,metode:m,nominal:n});
  saveData();closeForm();render();
}

// Firebase Auth Login
function login(){
  const email=document.getElementById('email').value;
  const password=document.getElementById('password').value;
  auth.signInWithEmailAndPassword(email,password).catch(e=>alert(e.message));
}
auth.onAuthStateChanged(user=>{
  if(user){
    isAdmin=true;
    status.textContent="ADMIN ON";
    welcome.classList.add("fadeOut");
    setTimeout(()=>{welcome.style.display="none";main.classList.add("show");},700);
  }
});

// Load default periode
loadData();
</script>

</body>
</html>
