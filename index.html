<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>KEUANGAN PRIBADI</title>

<!-- ===== FIREBASE (SCRIPT TAG / COMPAT) ===== -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyCcBqGjq9ZN4Cv-pDfNqaJ2QxnqSqzzPHE",
    authDomain: "keuangan-3ae83.firebaseapp.com",
    projectId: "keuangan-3ae83",
    storageBucket: "keuangan-3ae83.firebasestorage.app",
    messagingSenderId: "988326680959",
    appId: "1:988326680959:web:c2c39e4bed6cdf9c66a24a"
  };

  firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();

  /* ===== KUNCI MASALAH RELOAD (JANGAN DIHAPUS) ===== */
  auth.setPersistence(firebase.auth.Auth.Persistence.NONE);
</script>

<style>
:root{--gold:#d4af37;}
body,html{margin:0;height:100%;background:#000;color:#fff;font-family:Segoe UI}
button{cursor:pointer;border-radius:12px;border:1px solid var(--gold);background:transparent;color:var(--gold);padding:10px 16px}
button:hover{box-shadow:0 0 20px var(--gold)}
#welcome{height:100%;display:flex;flex-direction:column;justify-content:center;align-items:center}
#welcome input{margin:6px;width:600px;padding:10px;background:#111;color:#fff;border:1px solid var(--gold);border-radius:10px}
#main{display:none}
header{text-align:center;padding:20px;border-bottom:1px solid #333}
.card{margin:20px;padding:20px;border:1px solid #333;border-radius:16px}
.saldo{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:10px}
.box{padding:15px;border:1px solid #333;border-radius:12px}
.fab{position:fixed;right:20px;bottom:20px;width:60px;height:60px;border-radius:50%;background:var(--gold);color:#000;font-size:28px}
.modal{position:fixed;inset:0;display:none;background:rgba(0,0,0,.7);justify-content:center;align-items:center}
.modal-content{background:#000;padding:20px;border:1px solid var(--gold);border-radius:16px;width:300px}
input,select{width:100%;margin-top:8px;padding:8px;background:#111;color:#fff;border:1px solid #333;border-radius:8px}
table{width:100%;border-collapse:collapse}
th,td{padding:8px;border-bottom:1px solid #333}
</style>
</head>
<body>

<!-- ===== WELCOME SCREEN ===== -->
<div id="welcome">
  <h1 style="color:var(--gold)">KEUANGAN</h1>
  <p>Built and developed by Fajar Ilmanosa Viar . <b>V1.0.8</b> . Copyright Â© 2026 . All Rights Reserved.</p>
  <input id="email" placeholder="Email Admin">
  <input id="password" type="password" placeholder="Password">
  <button onclick="login()">LOGIN</button>
</div>

<!-- ===== MAIN APP ===== -->
<div id="main">
<header>
<h2 style="color:var(--gold)">KEUANGAN PRIBADI</h2>
<select id="bulan"></select>
<select id="tahun"></select>
</header>

<div class="card saldo">
  <div class="box">ATM<br><strong id="atm">0</strong></div>
  <div class="box">CASH<br><strong id="cash">0</strong></div>
  <div class="box">TOTAL<br><strong id="total">0</strong></div>
</div>

<div class="card">
<table>
<thead><tr><th>Tgl</th><th>Ket</th><th>Metode</th><th>Nominal</th></tr></thead>
<tbody id="list"></tbody>
</table>
</div>

<button class="fab" onclick="openForm()">+</button>
</div>

<!-- ===== MODAL ===== -->
<div class="modal" id="modal">
<div class="modal-content">
<select id="jenis">
  <option value="masuk">Pemasukan</option>
  <option value="keluar">Pengeluaran</option>
</select>
<select id="metode">
  <option value="atm">ATM</option>
  <option value="cash">Cash</option>
</select>
<input id="ket" placeholder="Keterangan">
<input id="nominal" type="number" placeholder="Nominal">
<button onclick="simpan()">Simpan</button>
<button onclick="closeForm()">Tutup</button>
</div>
</div>

<script>
let atm=0,cash=0,data=[],periode={}
const bulanEl=document.getElementById("bulan"),tahunEl=document.getElementById("tahun")
const bulanNama=["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Agu","Sep","Okt","Nov","Des"]

bulanNama.forEach((b,i)=>bulanEl.innerHTML+=`<option value="${i+1}">${b}</option>`)
for(let y=2020;y<=2035;y++)tahunEl.innerHTML+=`<option>${y}</option>`

periode.bulan=new Date().getMonth()+1
periode.tahun=new Date().getFullYear()
bulanEl.value=periode.bulan
tahunEl.value=periode.tahun

function key(){return `${periode.tahun}_${periode.bulan}`}
function load(){
  atm=+localStorage["atm_"+key()]||0
  cash=+localStorage["cash_"+key()]||0
  data=JSON.parse(localStorage["data_"+key()]||"[]")
  render()
}
function save(){
  localStorage["atm_"+key()]=atm
  localStorage["cash_"+key()]=cash
  localStorage["data_"+key()]=JSON.stringify(data)
}

const atmEl=document.getElementById("atm")
const cashEl=document.getElementById("cash")
const total=document.getElementById("total")
const list=document.getElementById("list")

function render(){
  atmEl.textContent=atm
  cashEl.textContent=cash
  total.textContent=atm+cash
  list.innerHTML=data.map(d=>`<tr><td>${d.tgl}</td><td>${d.ket}</td><td>${d.metode}</td><td>${d.nominal}</td></tr>`).join("")
}

bulanEl.onchange=tahunEl.onchange=()=>{periode.bulan=bulanEl.value;periode.tahun=tahunEl.value;load()}

function openForm(){modal.style.display="flex"}
function closeForm(){modal.style.display="none"}

function simpan(){
  const j=jenis.value,m=metode.value,n=+nominal.value
  if(j==="masuk"){m==="atm"?atm+=n:cash+=n}else{m==="atm"?atm-=n:cash-=n}
  data.unshift({tgl:new Date().toLocaleDateString(),ket:ket.value,metode:m,nominal:n})
  save();closeForm();render()
}

function login(){
  auth.signInWithEmailAndPassword(email.value,password.value)
  .catch(e=>alert(e.message))
}

auth.onAuthStateChanged(user=>{
  if(user){
    welcome.style.display="none"
    main.style.display="block"
    load()
  }else{
    welcome.style.display="flex"
    main.style.display="none"
  }
})
</script>
  
<script>
window.addEventListener("beforeunload", function (e) {
  e.preventDefault();
  e.returnValue = "";
});
</script>

</body>
</html>


